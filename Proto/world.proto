syntax = "proto3";

package world;

import "types.proto";
import "google/protobuf/timestamp.proto";

message RegisterServerReq {
	option (types.message_id) = kRegisterServerReq;
	string server_address = 1;
	types.ServerType server_type = 2;
	string level_map_name =3;
}

message RegisterServerRes {
	option (types.message_id) = kRegisterServerRes;
	types.Result result = 1;
	int32 server_id = 2;
}

message ServerPingReq {
	option (types.message_id) = kServerPingReq;
	int32 server_id = 1;
}

message ServerPingRes {
	option (types.message_id) = kServerPingReq;
	types.Result result =1;
	int32 server_id = 2;
}

message HelloWorldServer {
	option (types.message_id) = kHelloWorldServer;
	string user_id = 1;
	string access_token = 2;
	int64 playing_character_id = 3;
	int32 playing_server_id = 4;
}

message HelloWorldClient {
	option (types.message_id) = kHelloWorldClient;
	int32 map_uid = 1;
	int32 server_tick_interval_ms = 2;
}

message ClientEnterMapReq {
	option (types.message_id) = kClientEnterMapReq;
	int32 map_uid = 1;
	types.CharacterPose character_pos = 2;
}

message ClientEnterMapRes {
	option (types.message_id) = kClientEnterMapRes;
	types.Result result = 1;
	int32 map_uid = 2;
}

message ClientEnterMapNotify {
	option (types.message_id) = kClientEnterMapNotify;
	types.SectionInfo section_info = 1;
}

message ClientLeaveMapNotify {
	option (types.message_id) = kClientLeaveMapNotify;
	types.SectionInfo section_info = 2;
}

message ClientMoveReq {
	option (types.message_id) = kClientMoveReq;
	types.CharacterPose character_pos = 1;
	float client_timestamp = 3;
}

message ClientMoveRes {
	option (types.message_id) = kClientMoveRes;
	types.CharacterPose character_pos = 2;
	float client_timestamp = 3;
	google.protobuf.Timestamp server_timestamp = 4;
}

message ClientActionReq {
	option (types.message_id) = kClientActionReq;
	types.ClientAction client_action = 1;
	float client_timestamp = 2;
}

message ClientActionRes {
	option (types.message_id) = kClientActionRes;
	types.Result result = 1;
	types.ClientAction client_action = 2;
	float client_timestamp = 3;
	google.protobuf.Timestamp server_timestamp = 4;
}

message OtherClientActionNotify {
	option (types.message_id) = kOtherClientActionNotify;
	int64 character_id = 1;
	types.ClientAction client_action = 2;
}

message OtherClientEnterNotify {
	option (types.message_id) = kOtherClientEnterNotify;
	int64 character_id = 1;
	int32 server_id = 2;
	types.CharacterPose character_pos = 3;
	types.SectionInfo section_info = 4;
}

message OtherClientLeaveNotify {
	option (types.message_id) = kOtherClientLeaveNotify;
	int64 character_id = 1;
	types.SectionInfo section_info = 3;
}

message OtherClientMoveNotify {
	option (types.message_id) = kOtherClientMoveNotify;
	int64 character_id = 1;
	types.CharacterPose character_pos = 2;
	types.ClientAction client_action = 3;
}

message ChangeServerTickIntervalReq {
	option (types.message_id) = kChangeServerTickIntervalReq;
	int32 server_tick_interval_ms = 2;
}

message ChangeServerTickIntervalRes {
	option (types.message_id) = kChangeServerTickIntervalRes;
	int32 server_tick_interval_ms = 2;
}

message ServerTickIntervalChangedNotify {
	option (types.message_id) = kServerTickIntervalChangedNotify;
	int32 server_tick_interval_ms = 2;
}